import{E as ft,V as C,M as J,T as ee,S as He,Q as Ge,a as z,R as yt,P as wt,b as Et,D as bt,H as le,F as fe,c as ce,L as Mt,d as Ye,G as Te,e as Ze,f as V,N as ye,g as Se,h as we,i as ue,A as pe,C as xt,B as St,j as Ve,k as Ee,l as Lt,m as Tt,n as Pt,o as Rt,p as Ct,q as At,r as _t,s as qe,t as It,u as Dt,v as zt,W as Ot,w as jt,x as kt,y as Nt,z as vt,I as Ue,O as Ft}from"./three-CMy_aJcw.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}})();const Ke={type:"change"},be={type:"start"},$e={type:"end"},he=new yt,Xe=new wt,Bt=Math.cos(70*Et.DEG2RAD);class Ht extends ft{constructor(o,i){super(),this.object=o,this.domElement=i,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new C,this.cursor=new C,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:J.ROTATE,MIDDLE:J.DOLLY,RIGHT:J.PAN},this.touches={ONE:ee.ROTATE,TWO:ee.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return c.phi},this.getAzimuthalAngle=function(){return c.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",ge),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ge),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(Ke),e.update(),a=n.NONE},this.update=function(){const t=new C,s=new Ge().setFromUnitVectors(o.up,new C(0,1,0)),d=s.clone().invert(),f=new C,T=new Ge,W=new C,D=2*Math.PI;return function(gt=null){const Fe=e.object.position;t.copy(Fe).sub(e.target),t.applyQuaternion(s),c.setFromVector3(t),e.autoRotate&&a===n.NONE&&y(m(gt)),e.enableDamping?(c.theta+=x.theta*e.dampingFactor,c.phi+=x.phi*e.dampingFactor):(c.theta+=x.theta,c.phi+=x.phi);let Y=e.minAzimuthAngle,U=e.maxAzimuthAngle;isFinite(Y)&&isFinite(U)&&(Y<-Math.PI?Y+=D:Y>Math.PI&&(Y-=D),U<-Math.PI?U+=D:U>Math.PI&&(U-=D),Y<=U?c.theta=Math.max(Y,Math.min(U,c.theta)):c.theta=c.theta>(Y+U)/2?Math.max(Y,c.theta):Math.min(U,c.theta)),c.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,c.phi)),c.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(L,e.dampingFactor):e.target.add(L),e.target.sub(e.cursor),e.target.clampLength(e.minTargetRadius,e.maxTargetRadius),e.target.add(e.cursor);let ne=!1;if(e.zoomToCursor&&X||e.object.isOrthographicCamera)c.radius=R(c.radius);else{const K=c.radius;c.radius=R(c.radius*S),ne=K!=c.radius}if(t.setFromSpherical(c),t.applyQuaternion(d),Fe.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(x.theta*=1-e.dampingFactor,x.phi*=1-e.dampingFactor,L.multiplyScalar(1-e.dampingFactor)):(x.set(0,0,0),L.set(0,0,0)),e.zoomToCursor&&X){let K=null;if(e.object.isPerspectiveCamera){const ie=t.length();K=R(ie*S);const re=ie-K;e.object.position.addScaledVector(Z,re),e.object.updateMatrixWorld(),ne=!!re}else if(e.object.isOrthographicCamera){const ie=new C(_.x,_.y,0);ie.unproject(e.object);const re=e.object.zoom;e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/S)),e.object.updateProjectionMatrix(),ne=re!==e.object.zoom;const Be=new C(_.x,_.y,0);Be.unproject(e.object),e.object.position.sub(Be).add(ie),e.object.updateMatrixWorld(),K=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;K!==null&&(this.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(K).add(e.object.position):(he.origin.copy(e.object.position),he.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(he.direction))<Bt?o.lookAt(e.target):(Xe.setFromNormalAndCoplanarPoint(e.object.up,e.target),he.intersectPlane(Xe,e.target))))}else if(e.object.isOrthographicCamera){const K=e.object.zoom;e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/S)),K!==e.object.zoom&&(e.object.updateProjectionMatrix(),ne=!0)}return S=1,X=!1,ne||f.distanceToSquared(e.object.position)>l||8*(1-T.dot(e.object.quaternion))>l||W.distanceToSquared(e.target)>l?(e.dispatchEvent(Ke),f.copy(e.object.position),T.copy(e.object.quaternion),W.copy(e.target),!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",Ne),e.domElement.removeEventListener("pointerdown",De),e.domElement.removeEventListener("pointercancel",oe),e.domElement.removeEventListener("wheel",ze),e.domElement.removeEventListener("pointermove",me),e.domElement.removeEventListener("pointerup",oe),e.domElement.getRootNode().removeEventListener("keydown",Oe,{capture:!0}),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",ge),e._domElementKeyEvents=null)};const e=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=n.NONE;const l=1e-6,c=new He,x=new He;let S=1;const L=new C,P=new z,v=new z,$=new z,F=new z,B=new z,O=new z,A=new z,H=new z,k=new z,Z=new C,_=new z;let X=!1;const E=[],r={};let p=!1;function m(t){return t!==null?2*Math.PI/60*e.autoRotateSpeed*t:2*Math.PI/60/60*e.autoRotateSpeed}function g(t){const s=Math.abs(t*.01);return Math.pow(.95,e.zoomSpeed*s)}function y(t){x.theta-=t}function w(t){x.phi-=t}const h=function(){const t=new C;return function(d,f){t.setFromMatrixColumn(f,0),t.multiplyScalar(-d),L.add(t)}}(),M=function(){const t=new C;return function(d,f){e.screenSpacePanning===!0?t.setFromMatrixColumn(f,1):(t.setFromMatrixColumn(f,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(d),L.add(t)}}(),u=function(){const t=new C;return function(d,f){const T=e.domElement;if(e.object.isPerspectiveCamera){const W=e.object.position;t.copy(W).sub(e.target);let D=t.length();D*=Math.tan(e.object.fov/2*Math.PI/180),h(2*d*D/T.clientHeight,e.object.matrix),M(2*f*D/T.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(h(d*(e.object.right-e.object.left)/e.object.zoom/T.clientWidth,e.object.matrix),M(f*(e.object.top-e.object.bottom)/e.object.zoom/T.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function N(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?S/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function te(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?S*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function G(t,s){if(!e.zoomToCursor)return;X=!0;const d=e.domElement.getBoundingClientRect(),f=t-d.left,T=s-d.top,W=d.width,D=d.height;_.x=f/W*2-1,_.y=-(T/D)*2+1,Z.set(_.x,_.y,1).unproject(e.object).sub(e.object.position).normalize()}function R(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function se(t){P.set(t.clientX,t.clientY)}function j(t){G(t.clientX,t.clientX),A.set(t.clientX,t.clientY)}function I(t){F.set(t.clientX,t.clientY)}function ae(t){v.set(t.clientX,t.clientY),$.subVectors(v,P).multiplyScalar(e.rotateSpeed);const s=e.domElement;y(2*Math.PI*$.x/s.clientHeight),w(2*Math.PI*$.y/s.clientHeight),P.copy(v),e.update()}function et(t){H.set(t.clientX,t.clientY),k.subVectors(H,A),k.y>0?N(g(k.y)):k.y<0&&te(g(k.y)),A.copy(H),e.update()}function tt(t){B.set(t.clientX,t.clientY),O.subVectors(B,F).multiplyScalar(e.panSpeed),u(O.x,O.y),F.copy(B),e.update()}function ot(t){G(t.clientX,t.clientY),t.deltaY<0?te(g(t.deltaY)):t.deltaY>0&&N(g(t.deltaY)),e.update()}function nt(t){let s=!1;switch(t.code){case e.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?w(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):u(0,e.keyPanSpeed),s=!0;break;case e.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?w(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):u(0,-e.keyPanSpeed),s=!0;break;case e.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?y(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):u(e.keyPanSpeed,0),s=!0;break;case e.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?y(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):u(-e.keyPanSpeed,0),s=!0;break}s&&(t.preventDefault(),e.update())}function Pe(t){if(E.length===1)P.set(t.pageX,t.pageY);else{const s=Q(t),d=.5*(t.pageX+s.x),f=.5*(t.pageY+s.y);P.set(d,f)}}function Re(t){if(E.length===1)F.set(t.pageX,t.pageY);else{const s=Q(t),d=.5*(t.pageX+s.x),f=.5*(t.pageY+s.y);F.set(d,f)}}function Ce(t){const s=Q(t),d=t.pageX-s.x,f=t.pageY-s.y,T=Math.sqrt(d*d+f*f);A.set(0,T)}function it(t){e.enableZoom&&Ce(t),e.enablePan&&Re(t)}function st(t){e.enableZoom&&Ce(t),e.enableRotate&&Pe(t)}function Ae(t){if(E.length==1)v.set(t.pageX,t.pageY);else{const d=Q(t),f=.5*(t.pageX+d.x),T=.5*(t.pageY+d.y);v.set(f,T)}$.subVectors(v,P).multiplyScalar(e.rotateSpeed);const s=e.domElement;y(2*Math.PI*$.x/s.clientHeight),w(2*Math.PI*$.y/s.clientHeight),P.copy(v)}function _e(t){if(E.length===1)B.set(t.pageX,t.pageY);else{const s=Q(t),d=.5*(t.pageX+s.x),f=.5*(t.pageY+s.y);B.set(d,f)}O.subVectors(B,F).multiplyScalar(e.panSpeed),u(O.x,O.y),F.copy(B)}function Ie(t){const s=Q(t),d=t.pageX-s.x,f=t.pageY-s.y,T=Math.sqrt(d*d+f*f);H.set(0,T),k.set(0,Math.pow(H.y/A.y,e.zoomSpeed)),N(k.y),A.copy(H);const W=(t.pageX+s.x)*.5,D=(t.pageY+s.y)*.5;G(W,D)}function at(t){e.enableZoom&&Ie(t),e.enablePan&&_e(t)}function rt(t){e.enableZoom&&Ie(t),e.enableRotate&&Ae(t)}function De(t){e.enabled!==!1&&(E.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",me),e.domElement.addEventListener("pointerup",oe)),!mt(t)&&(ut(t),t.pointerType==="touch"?ke(t):lt(t)))}function me(t){e.enabled!==!1&&(t.pointerType==="touch"?dt(t):ct(t))}function oe(t){switch(pt(t),E.length){case 0:e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",me),e.domElement.removeEventListener("pointerup",oe),e.dispatchEvent($e),a=n.NONE;break;case 1:const s=E[0],d=r[s];ke({pointerId:s,pageX:d.x,pageY:d.y});break}}function lt(t){let s;switch(t.button){case 0:s=e.mouseButtons.LEFT;break;case 1:s=e.mouseButtons.MIDDLE;break;case 2:s=e.mouseButtons.RIGHT;break;default:s=-1}switch(s){case J.DOLLY:if(e.enableZoom===!1)return;j(t),a=n.DOLLY;break;case J.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;I(t),a=n.PAN}else{if(e.enableRotate===!1)return;se(t),a=n.ROTATE}break;case J.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;se(t),a=n.ROTATE}else{if(e.enablePan===!1)return;I(t),a=n.PAN}break;default:a=n.NONE}a!==n.NONE&&e.dispatchEvent(be)}function ct(t){switch(a){case n.ROTATE:if(e.enableRotate===!1)return;ae(t);break;case n.DOLLY:if(e.enableZoom===!1)return;et(t);break;case n.PAN:if(e.enablePan===!1)return;tt(t);break}}function ze(t){e.enabled===!1||e.enableZoom===!1||a!==n.NONE||(t.preventDefault(),e.dispatchEvent(be),ot(ht(t)),e.dispatchEvent($e))}function ht(t){const s=t.deltaMode,d={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(s){case 1:d.deltaY*=16;break;case 2:d.deltaY*=100;break}return t.ctrlKey&&!p&&(d.deltaY*=10),d}function Oe(t){t.key==="Control"&&(p=!0,e.domElement.getRootNode().addEventListener("keyup",je,{passive:!0,capture:!0}))}function je(t){t.key==="Control"&&(p=!1,e.domElement.getRootNode().removeEventListener("keyup",je,{passive:!0,capture:!0}))}function ge(t){e.enabled===!1||e.enablePan===!1||nt(t)}function ke(t){switch(ve(t),E.length){case 1:switch(e.touches.ONE){case ee.ROTATE:if(e.enableRotate===!1)return;Pe(t),a=n.TOUCH_ROTATE;break;case ee.PAN:if(e.enablePan===!1)return;Re(t),a=n.TOUCH_PAN;break;default:a=n.NONE}break;case 2:switch(e.touches.TWO){case ee.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;it(t),a=n.TOUCH_DOLLY_PAN;break;case ee.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;st(t),a=n.TOUCH_DOLLY_ROTATE;break;default:a=n.NONE}break;default:a=n.NONE}a!==n.NONE&&e.dispatchEvent(be)}function dt(t){switch(ve(t),a){case n.TOUCH_ROTATE:if(e.enableRotate===!1)return;Ae(t),e.update();break;case n.TOUCH_PAN:if(e.enablePan===!1)return;_e(t),e.update();break;case n.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;at(t),e.update();break;case n.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;rt(t),e.update();break;default:a=n.NONE}}function Ne(t){e.enabled!==!1&&t.preventDefault()}function ut(t){E.push(t.pointerId)}function pt(t){delete r[t.pointerId];for(let s=0;s<E.length;s++)if(E[s]==t.pointerId){E.splice(s,1);return}}function mt(t){for(let s=0;s<E.length;s++)if(E[s]==t.pointerId)return!0;return!1}function ve(t){let s=r[t.pointerId];s===void 0&&(s=new z,r[t.pointerId]=s),s.set(t.pageX,t.pageY)}function Q(t){const s=t.pointerId===E[0]?E[1]:E[0];return r[s]}e.domElement.addEventListener("contextmenu",Ne),e.domElement.addEventListener("pointerdown",De),e.domElement.addEventListener("pointercancel",oe),e.domElement.addEventListener("wheel",ze,{passive:!1}),e.domElement.getRootNode().addEventListener("keydown",Oe,{passive:!0,capture:!0}),this.update()}}class Gt extends bt{constructor(o){super(o),this.type=le}parse(o){const l=function(r,p){switch(r){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(p||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(p||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(p||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(p||""))}},L=`
`,P=function(r,p,m){p=p||1024;let y=r.pos,w=-1,h=0,M="",u=String.fromCharCode.apply(null,new Uint16Array(r.subarray(y,y+128)));for(;0>(w=u.indexOf(L))&&h<p&&y<r.byteLength;)M+=u,h+=u.length,y+=128,u+=String.fromCharCode.apply(null,new Uint16Array(r.subarray(y,y+128)));return-1<w?(r.pos+=h+w+1,M+u.slice(0,w)):!1},v=function(r){const p=/^#\?(\S+)/,m=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,g=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,y=/^\s*FORMAT=(\S+)\s*$/,w=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,h={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let M,u;for((r.pos>=r.byteLength||!(M=P(r)))&&l(1,"no header found"),(u=M.match(p))||l(3,"bad initial token"),h.valid|=1,h.programtype=u[1],h.string+=M+`
`;M=P(r),M!==!1;){if(h.string+=M+`
`,M.charAt(0)==="#"){h.comments+=M+`
`;continue}if((u=M.match(m))&&(h.gamma=parseFloat(u[1])),(u=M.match(g))&&(h.exposure=parseFloat(u[1])),(u=M.match(y))&&(h.valid|=2,h.format=u[1]),(u=M.match(w))&&(h.valid|=4,h.height=parseInt(u[1],10),h.width=parseInt(u[2],10)),h.valid&2&&h.valid&4)break}return h.valid&2||l(3,"missing format specifier"),h.valid&4||l(3,"missing image size specifier"),h},$=function(r,p,m){const g=p;if(g<8||g>32767||r[0]!==2||r[1]!==2||r[2]&128)return new Uint8Array(r);g!==(r[2]<<8|r[3])&&l(3,"wrong scanline width");const y=new Uint8Array(4*p*m);y.length||l(4,"unable to allocate buffer space");let w=0,h=0;const M=4*g,u=new Uint8Array(4),N=new Uint8Array(M);let te=m;for(;te>0&&h<r.byteLength;){h+4>r.byteLength&&l(1),u[0]=r[h++],u[1]=r[h++],u[2]=r[h++],u[3]=r[h++],(u[0]!=2||u[1]!=2||(u[2]<<8|u[3])!=g)&&l(3,"bad rgbe scanline format");let G=0,R;for(;G<M&&h<r.byteLength;){R=r[h++];const j=R>128;if(j&&(R-=128),(R===0||G+R>M)&&l(3,"bad scanline data"),j){const I=r[h++];for(let ae=0;ae<R;ae++)N[G++]=I}else N.set(r.subarray(h,h+R),G),G+=R,h+=R}const se=g;for(let j=0;j<se;j++){let I=0;y[w]=N[j+I],I+=g,y[w+1]=N[j+I],I+=g,y[w+2]=N[j+I],I+=g,y[w+3]=N[j+I],w+=4}te--}return y},F=function(r,p,m,g){const y=r[p+3],w=Math.pow(2,y-128)/255;m[g+0]=r[p+0]*w,m[g+1]=r[p+1]*w,m[g+2]=r[p+2]*w,m[g+3]=1},B=function(r,p,m,g){const y=r[p+3],w=Math.pow(2,y-128)/255;m[g+0]=ce.toHalfFloat(Math.min(r[p+0]*w,65504)),m[g+1]=ce.toHalfFloat(Math.min(r[p+1]*w,65504)),m[g+2]=ce.toHalfFloat(Math.min(r[p+2]*w,65504)),m[g+3]=ce.toHalfFloat(1)},O=new Uint8Array(o);O.pos=0;const A=v(O),H=A.width,k=A.height,Z=$(O.subarray(O.pos),H,k);let _,X,E;switch(this.type){case fe:E=Z.length/4;const r=new Float32Array(E*4);for(let m=0;m<E;m++)F(Z,m*4,r,m*4);_=r,X=fe;break;case le:E=Z.length/4;const p=new Uint16Array(E*4);for(let m=0;m<E;m++)B(Z,m*4,p,m*4);_=p,X=le;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:H,height:k,data:_,header:A.string,gamma:A.gamma,exposure:A.exposure,type:X}}setDataType(o){return this.type=o,this}load(o,i,e,n){function a(l,c){switch(l.type){case fe:case le:l.colorSpace=Mt,l.minFilter=Ye,l.magFilter=Ye,l.generateMipmaps=!1,l.flipY=!0;break}i&&i(l,c)}return super.load(o,a,e,n)}}class Yt{constructor({loadingManager:o,texturePath:i}){console.log("Earth constructor called with:",{loadingManager:o,texturePath:i}),this.loadingManager=o,this.texturePath=i,this.radius=6.371,this.rotationSpeed=.05,this.group=new Te,this.textures={diffuse:null,normal:null,roughness:null,specular:null,night:null,clouds:null,height:null}}async initialize(){try{console.log("Initializing Earth...");const o=new Ze(this.loadingManager);console.log("TextureLoader created"),console.log("Loading diffuse texture..."),this.textures.diffuse=await this.loadTexture(o,"earth-day.jpg",{colorSpace:V}),console.log("Loading normal texture..."),this.textures.normal=await this.loadTexture(o,"normal.jpg",{colorSpace:ye}),console.log("Loading roughness texture..."),this.textures.roughness=await this.loadTexture(o,"roughness.jpg",{colorSpace:ye}),console.log("Loading specular texture..."),this.textures.specular=await this.loadTexture(o,"specular.jpg",{colorSpace:V}),console.log("Loading night texture..."),this.textures.night=await this.loadTexture(o,"earth-night.jpg",{colorSpace:V}),console.log("Loading clouds texture..."),this.textures.clouds=await this.loadTexture(o,"earth-clouds-transparency.png",{colorSpace:V,transparent:!0}),console.log("Loading height texture..."),this.textures.height=await this.loadTexture(o,"height.jpg",{colorSpace:ye}),console.log("All textures loaded successfully");const i=new Se(this.radius,64,64),e=new we({map:this.textures.diffuse,normalMap:this.textures.normal,roughnessMap:this.textures.roughness,metalnessMap:this.textures.specular,normalScale:new z(.5,.5),roughness:.7,metalness:.1,envMapIntensity:1,dithering:!0}),n=new we({map:this.textures.night,emissive:this.textures.night,emissiveIntensity:1,transparent:!0,opacity:.8,dithering:!0}),a=new ue(i,e),l=new ue(i,n);l.rotation.y=Math.PI;const c=new Se(this.radius+.1,64,64),x=new we({map:this.textures.clouds,transparent:!0,opacity:.4,blending:pe,depthWrite:!1,dithering:!0}),S=new ue(c,x);return a.frustumCulled=!0,l.frustumCulled=!0,S.frustumCulled=!0,console.log("Adding meshes to group..."),this.group.add(a),this.group.add(l),this.group.add(S),this.earthMesh=a,this.nightMesh=l,this.cloudMesh=S,this.group.position.set(0,0,0),console.log("Earth group position:",this.group.position),console.log("Earth initialization complete"),this.group}catch(o){throw console.error("Error initializing Earth:",o),o}}async loadTexture(o,i,e={}){try{console.log(`Loading texture: ${i}`);const n=await o.loadAsync(`${this.texturePath}${i}`);return console.log(`Texture loaded successfully: ${i}`),n.colorSpace=e.colorSpace||V,e.transparent&&(n.transparent=!0),n}catch(n){return console.error(`Error loading texture ${i}:`,n),console.log(`Creating fallback texture for ${i}`),this.createFallbackTexture(e.colorSpace)}}createFallbackTexture(o){console.log("Creating fallback texture");const i=document.createElement("canvas");i.width=2,i.height=2;const e=i.getContext("2d");e.fillStyle="#444444",e.fillRect(0,0,2,2);const n=new xt(i);return n.colorSpace=o||V,n}update(o){if(this.group){const i=Math.min(o,.016);this.group.rotation.y+=this.rotationSpeed*i,this.cloudMesh&&(this.cloudMesh.rotation.y+=this.rotationSpeed*1.2*i)}}dispose(){for(console.log("Disposing Earth component..."),Object.entries(this.textures).forEach(([o,i])=>{i&&i.dispose&&(console.log(`Disposing texture: ${o}`),i.dispose())}),this.earthMesh&&(console.log("Disposing Earth mesh"),this.earthMesh.geometry.dispose(),this.earthMesh.material.dispose()),this.nightMesh&&(console.log("Disposing night mesh"),this.nightMesh.geometry.dispose(),this.nightMesh.material.dispose()),this.cloudMesh&&(console.log("Disposing cloud mesh"),this.cloudMesh.geometry.dispose(),this.cloudMesh.material.dispose()),console.log("Clearing Earth group");this.group.children.length>0;)this.group.remove(this.group.children[0])}}class Ut{constructor(o={}){this.options={starCount:2e3,starSize:.1,starColor:16777215,starBrightness:1,...o},this.group=null,this.material=null,this.geometry=null}async initialize(){try{console.log("Initializing Starfield..."),this.group=new Te,this.geometry=new St;const o=new Float32Array(this.options.starCount*3),i=new Float32Array(this.options.starCount*3),e=new Float32Array(this.options.starCount);for(let a=0;a<this.options.starCount;a++){const l=a*3,c=100+Math.random()*50,x=Math.random()*Math.PI*2,S=Math.acos(2*Math.random()-1);o[l]=c*Math.sin(S)*Math.cos(x),o[l+1]=c*Math.sin(S)*Math.sin(x),o[l+2]=c*Math.cos(S);const L=new Ve(this.options.starColor),P=.8+Math.random()*.4;i[l]=L.r*P,i[l+1]=L.g*P,i[l+2]=L.b*P,e[a]=this.options.starSize*(.5+Math.random()*1.5)}this.geometry.setAttribute("position",new Ee(o,3)),this.geometry.setAttribute("color",new Ee(i,3)),this.geometry.setAttribute("size",new Ee(e,1)),this.material=new Lt({size:this.options.starSize,vertexColors:!0,transparent:!0,opacity:this.options.starBrightness,sizeAttenuation:!0,blending:pe,depthWrite:!1});const n=new Tt(this.geometry,this.material);return this.group.add(n),console.log("Starfield initialized successfully"),this.group}catch(o){throw console.error("Error initializing Starfield:",o),o}}update(o){if(this.material){const i=Date.now()*.001;this.material.opacity=this.options.starBrightness*(.8+Math.sin(i)*.2)}}dispose(){this.geometry&&this.geometry.dispose(),this.material&&this.material.dispose(),this.group&&(this.group.clear(),this.group=null)}}class Kt{constructor(o={}){this.options={color:16777164,intensity:1,distance:100,decay:2,...o},this.group=null,this.light=null,this.glowMesh=null}async initialize(){try{console.log("Initializing SunGlow..."),this.group=new Te,this.light=new Pt(this.options.color,this.options.intensity,this.options.distance,this.options.decay),this.light.position.set(50,20,50),this.group.add(this.light);const o=new Se(5,32,32),i=new Rt({color:this.options.color,transparent:!0,opacity:.3,blending:pe,side:Ct});this.glowMesh=new ue(o,this.light.position),this.glowMesh.material=i,this.group.add(this.glowMesh);const e=new Ze,n=await new Promise((c,x)=>{e.load("/assets/sun/flare.png",c,void 0,x)}),a=new At({map:n,color:this.options.color,transparent:!0,blending:pe}),l=new _t(a);return l.scale.set(20,20,1),l.position.copy(this.light.position),this.group.add(l),console.log("SunGlow initialized successfully"),this.group}catch(o){throw console.error("Error initializing SunGlow:",o),o}}update(o){if(this.glowMesh){const i=Date.now()*.001,e=1+Math.sin(i)*.1;this.glowMesh.scale.set(e,e,e),this.glowMesh.material.opacity=.3+Math.sin(i*.5)*.1}}dispose(){this.glowMesh&&(this.glowMesh.geometry.dispose(),this.glowMesh.material.dispose()),this.group&&(this.group.clear(),this.group=null)}}class $t{constructor(o,i){if(console.log("SceneManager constructor called with container:",o),!o||!(o instanceof HTMLElement))throw new Error("Container must be a valid HTML element");o.id||console.warn("Container element has no ID, this may cause issues with event handling"),this.container=o,this.loadingManager=i||new qe,this.scene=null,this.camera=null,this.renderer=null,this.controls=null,this.clock=new It,this.components=new Map,this.eventHandlers=new Map,this.isInitialized=!1,this.envMap=null,this.isContextLost=!1,this.lastFrameTime=0,this.containerWidth=o.clientWidth,this.containerHeight=o.clientHeight}async init(){if(this.isInitialized){console.log("SceneManager already initialized");return}console.log("SceneManager init started");try{if(!this.container||!this.container.isConnected)throw new Error("Container element is no longer valid");this.scene=new Dt,this.scene.background=new Ve(0),console.log("Scene created");const o=this.containerWidth/this.containerHeight;if(this.camera=new zt(45,o,.1,1e3),this.camera.position.set(0,0,20),console.log("Camera created with aspect ratio:",o),this.renderer=new Ot({antialias:!0,alpha:!0,powerPreference:"high-performance",preserveDrawingBuffer:!1,precision:"highp"}),this.renderer.setSize(this.containerWidth,this.containerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,1.5)),this.renderer.outputColorSpace=V,this.renderer.toneMapping=jt,this.renderer.toneMappingExposure=1.2,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=kt,this.renderer.physicallyCorrectLights=!0,this.renderer.outputEncoding=void 0,!this.container.isConnected)throw new Error("Container element was removed from DOM");this.container.appendChild(this.renderer.domElement),console.log("Renderer appended to container"),this.renderer.domElement.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.renderer.domElement.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),console.log("Loading HDRI environment...");const i=new Gt(this.loadingManager);this.envMap=await i.loadAsync("/assets/environment/space_hdri.hdr"),this.envMap.mapping=Nt,this.scene.environment=this.envMap,this.scene.background=this.envMap,console.log("HDRI environment loaded"),this.controls=new Ht(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.08,this.controls.minDistance=10,this.controls.maxDistance=50,this.controls.maxPolarAngle=Math.PI*.95,this.controls.rotateSpeed=.4,this.controls.zoomSpeed=.6,this.controls.enablePan=!1,this.controls.autoRotate=!1,this.controls.enableSmoothing=!0,this.controls.smoothTime=.3,this.controls.update(),console.log("Controls created"),window.addEventListener("resize",this.onResize.bind(this)),this.onResize(),console.log("Event listeners setup complete"),this.isInitialized=!0;const e=new vt(4210752,.3);this.scene.add(e);const n=new Ue(16777215,1.2);n.position.set(50,20,50),n.castShadow=!0,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.near=.5,n.shadow.camera.far=500,n.shadow.camera.left=-50,n.shadow.camera.right=50,n.shadow.camera.top=50,n.shadow.camera.bottom=-50,n.shadow.bias=-1e-4,n.shadow.normalBias=.02,n.shadow.radius=1.5,this.scene.add(n);const a=new Ue(4210943,.2);a.position.set(-50,-20,-50),this.scene.add(a),this.animate(),console.log("SceneManager initialization complete")}catch(o){throw console.error("Error in SceneManager initialization:",o),this.isInitialized=!1,o}}handleContextLost(o){o.preventDefault(),console.log("WebGL context lost"),this.isContextLost=!0}async handleContextRestored(){console.log("WebGL context restored"),this.isContextLost=!1;for(const[o,i]of this.components)if(typeof i.initialize=="function")try{await i.initialize()}catch(e){console.error(`Error reinitializing component ${o}:`,e)}}onResize(){if(!this.camera||!this.renderer)return;const o=this.container.clientWidth,i=this.container.clientHeight;this.camera.aspect=o/i,this.camera.updateProjectionMatrix(),this.renderer.setSize(o,i)}async addComponent(o,i){if(!this.isInitialized)throw new Error("SceneManager must be initialized before adding components");console.log(`Adding component: ${o}`);try{if(this.components.has(o)&&(console.log(`Component ${o} already exists, removing old one`),await this.removeComponent(o)),typeof i.initialize=="function"){console.log(`Initializing component: ${o}`);const e=await i.initialize();e instanceof Ft&&(console.log(`Adding ${o} to scene`),this.scene.add(e))}return this.components.set(o,i),console.log(`Component ${o} added successfully`),i}catch(e){throw console.error(`Error adding component ${o}:`,e),e}}async removeComponent(o){console.log(`Removing component: ${o}`);const i=this.components.get(o);if(i)try{typeof i.dispose=="function"&&await i.dispose(),this.components.delete(o),console.log(`Component ${o} removed successfully`)}catch(e){throw console.error(`Error removing component ${o}:`,e),e}}update(){if(!this.isInitialized||this.isContextLost)return;const o=Math.min(this.clock.getDelta(),.1);this.controls&&o>0&&this.controls.update();for(const i of this.components.values())if(typeof i.update=="function")try{i.update(o)}catch(e){console.error("Error updating component:",e)}this.renderer&&this.scene&&this.camera&&!this.isContextLost&&this.renderer.render(this.scene,this.camera)}animate(){this.isInitialized&&requestAnimationFrame(o=>{this.animate(),o-this.lastFrameTime>=16.67&&(this.update(),this.lastFrameTime=o)})}async dispose(){console.log("Disposing SceneManager");try{this.renderer&&this.renderer.domElement&&(this.renderer.domElement.removeEventListener("webglcontextlost",this.handleContextLost),this.renderer.domElement.removeEventListener("webglcontextrestored",this.handleContextRestored));for(const[o,i]of this.components)await this.removeComponent(o);for(const[o,i]of this.eventHandlers)window.removeEventListener(o,i);this.controls&&this.controls.dispose(),this.renderer&&(this.renderer.dispose(),this.container.removeChild(this.renderer.domElement)),this.components.clear(),this.eventHandlers.clear(),this.isInitialized=!1,console.log("SceneManager disposed successfully")}catch(o){throw console.error("Error disposing SceneManager:",o),o}}}let q=null,de=0;const We=3;let Me=performance.now(),xe=0;function Qe(){const b=performance.now();if(xe++,b-Me>=1e3){const o=Math.round(xe*1e3/(b-Me));console.log(`FPS: ${o}`),xe=0,Me=b}requestAnimationFrame(Qe)}async function Je(){try{console.log("Starting application initialization...");const b=document.getElementById("container");if(!b)throw new Error("Container element not found");console.log("Container found:",b);const o=new qe,i=document.getElementById("loading-progress-bar"),e=document.getElementById("loading-text");o.onProgress=(c,x,S)=>{const L=x/S*100;i.style.width=L+"%",e.textContent=`Loading: ${Math.round(L)}%`,console.log(`Loading progress: ${L.toFixed(2)}% - ${c}`)},o.onError=c=>{console.error("Error loading:",c),Le(`Failed to load resource: ${c}. Please refresh the page.`)},o.onLoad=()=>{console.log("All resources loaded successfully"),Xt()},q=new $t(b,o),console.log("Initializing SceneManager..."),await q.init(),console.log("Adding starfield...");const n=new Ut({starCount:2e3,starSize:.1,starColor:16777215,starBrightness:1});await q.addComponent("starfield",n),console.log("Adding sun glow...");const a=new Kt({color:16777164,intensity:1,distance:100,decay:2});await q.addComponent("sunGlow",a),console.log("Creating Earth component...");const l=new Yt({loadingManager:o,texturePath:"/assets/earth/",options:{enableShadows:!0,enablePostProcessing:!0,postProcessingQuality:"medium",geometryDetail:"medium",textureQuality:"high",enableAtmosphere:!0,atmosphereQuality:"medium",enableClouds:!0,cloudQuality:"medium",enableNightLights:!0,nightLightsQuality:"medium",rotationSpeed:.15,enableAutoRotation:!1,atmosphereDensity:.8,cloudOpacity:.7,specularIntensity:.5,roughness:.7,metalness:.1,enableOceanReflection:!0,oceanReflectionQuality:"medium",enableAtmosphericScattering:!0,enableSpecularHighlights:!0,enableNormalMapping:!0,enableRimLighting:!0,enableAmbientOcclusion:!0,aoQuality:"medium"}});console.log("Adding Earth to scene..."),await q.addComponent("earth",l),console.log("Initialization complete!"),de=0}catch(b){console.error("Initialization error:",b),de++,de<We?(console.log(`Retrying initialization (attempt ${de+1}/${We})...`),setTimeout(Je,1e3)):Le("Failed to initialize Earth visualization. Please refresh the page or try again later.")}}function Le(b){const o=document.getElementById("error-message"),i=document.getElementById("loading"),e=document.getElementById("loading-progress");o.textContent=b,o.style.display="block",i.style.display="none",e.style.display="none"}function Xt(){const b=document.getElementById("loading"),o=document.getElementById("loading-text");o.textContent="Loading complete!",b.style.opacity="0",setTimeout(()=>{b.style.display="none"},500)}console.log("Starting application...");Je().catch(b=>{console.error("Fatal error during initialization:",b),Le("Fatal error during initialization. Please refresh the page or try again later.")});window.addEventListener("unload",()=>{q&&q.dispose()});Qe();
//# sourceMappingURL=index-CxElyJDj.js.map
